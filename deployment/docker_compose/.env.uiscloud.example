# =============================================================================
# UISCloud 프로덕션 환경변수 설정
#
# 사용법:
#   cp .env.uiscloud.example .env
#   nano .env   ← ⚠️ 실제 값으로 변경 필수!
#
# 보안 주의사항:
#   - 이 파일을 git에 커밋하지 마세요!
#   - POSTGRES_PASSWORD, MINIO_ROOT_PASSWORD, ENCRYPTION_KEY_SECRET는
#     반드시 강력한 값으로 변경하세요.
# =============================================================================


################################################################################
## 이미지 설정
################################################################################

# 업스트림 Onyx 이미지 버전 (backend, model-server)
IMAGE_TAG=latest

# UISCloud 커스텀 웹 서버 이미지 (GitHub Actions에서 자동 빌드)
# 형식: ghcr.io/{owner}/{repo}/web-server:{tag}
UISCLOUD_WEB_IMAGE=ghcr.io/rockgis/uiscloud_onyx/web-server:latest


################################################################################
## 인증 설정
################################################################################

# 인증 방식: basic | oidc | saml | oauth2 | google
AUTH_TYPE=basic

# 세션 만료 시간 (초), 기본 6시간
# SESSION_EXPIRE_TIME_SECONDS=21600

# ⚠️ 보안 키 (반드시 랜덤 값으로 설정하세요)
# 생성 방법: openssl rand -hex 32
ENCRYPTION_KEY_SECRET=CHANGE_ME_USE_openssl_rand_hex_32

# 가입 허용 이메일 도메인 (쉼표로 구분, 비워두면 모두 허용)
# VALID_EMAIL_DOMAINS=yourdomain.com


################################################################################
## 데이터베이스 설정
################################################################################

POSTGRES_USER=postgres
# ⚠️ 반드시 강력한 비밀번호로 변경하세요
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
# POSTGRES_DB=onyx


################################################################################
## 파일 스토리지 설정 (MinIO / S3 호환)
################################################################################

# 파일 저장 백엔드
FILE_STORE_BACKEND=s3
COMPOSE_PROFILES=s3-filestore

# MinIO 내부 접속 URL (Docker 네트워크 내부)
S3_ENDPOINT_URL=http://minio:9000
S3_FILE_STORE_BUCKET_NAME=onyx-file-store-bucket

# ⚠️ 반드시 강력한 비밀번호로 변경하세요
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=CHANGE_ME_STRONG_PASSWORD
S3_AWS_ACCESS_KEY_ID=minioadmin
S3_AWS_SECRET_ACCESS_KEY=CHANGE_ME_STRONG_PASSWORD


################################################################################
## 내부 서비스 연결 설정 (Docker 네트워크 내부 — 변경 불필요)
################################################################################

POSTGRES_HOST=relational_db
VESPA_HOST=index
REDIS_HOST=cache
MODEL_SERVER_HOST=inference_model_server
INDEXING_MODEL_SERVER_HOST=indexing_model_server
INTERNAL_URL=http://api_server:8080


################################################################################
## 로깅 설정
################################################################################

LOG_LEVEL=info

# Onyx 텔레메트리 비활성화 (사용 데이터 수집 거부 시 활성화)
# DISABLE_TELEMETRY=true


################################################################################
## Celery 백그라운드 워커 설정
################################################################################

# 경량 단일 워커 모드 (소규모 배포에 적합)
USE_LIGHTWEIGHT_BACKGROUND_WORKER=true


################################################################################
## Enterprise Edition 설정 (유료 라이선스 필요)
################################################################################

ENABLE_PAID_ENTERPRISE_EDITION_FEATURES=false


################################################################################
## 웹 도메인 설정
################################################################################

# 외부에서 접속하는 웹 도메인 (리다이렉트 URL 생성에 사용)
# WEB_DOMAIN=https://yourdomain.com


################################################################################
## 선택적 기능 설정
################################################################################

# 비밀번호 찾기 기능 활성화
NEXT_PUBLIC_FORGOT_PASSWORD_ENABLED=true

# 로그아웃 버튼 비활성화 (SSO 환경에서 사용)
# NEXT_PUBLIC_DISABLE_LOGOUT=true

# 사용자 정의 로그아웃 후 리다이렉트 URL
# NEXT_PUBLIC_CUSTOM_REFRESH_URL=

# 테마 설정 (기본값 사용 권장)
# NEXT_PUBLIC_THEME=

# Sentry 에러 트래킹 (선택사항)
# NEXT_PUBLIC_SENTRY_DSN=
# SENTRY_AUTH_TOKEN=
# SENTRY_ORG=
# SENTRY_PROJECT=


################################################################################
## 모델 서버 설정 (고급)
################################################################################

# 모델 서버 비활성화 (외부 LLM API만 사용 시)
# DISABLE_MODEL_SERVER=true

# Vespa 검색 스레드 수
# VESPA_SEARCHER_THREADS=1
